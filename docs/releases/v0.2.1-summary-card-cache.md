# v0.2.1-summary-card-cache

Summary Card の入力ハッシュによるキャッシュ。同一入力なら再生成しない。

## Added

### input_hash キャッシュ

```json
{
  "meta": {
    "input_hash": "a1b2c3d4e5f6..."
  }
}
```

| 入力 | ハッシュ計算 |
|------|-------------|
| result.json | 常に含む |
| conversation.jsonl | あれば含む |
| stdout.log / stderr.log | conversation.jsonl がない場合のフォールバック |

### キャッシュ動作

| 条件 | 動作 |
|------|------|
| input_hash が一致 | 既存カードを返す（AI 呼び出しなし） |
| input_hash が不一致 | 再生成 |
| `--force` オプション | キャッシュを無視して再生成 |

### CLI オプション

```bash
# 通常（キャッシュ有効）
python summary_card_generator.py <run_id>

# キャッシュ無視
python summary_card_generator.py <run_id> --force
```

## Changed

- `summary_card.schema.json` を v0.2.1 に更新
- `generate_summary_card()` に `force` パラメータ追加

## 効果

| Before | After |
|--------|-------|
| 毎回 AI 呼び出し | 入力未変更なら即時返却 |
| verify-runs で全 run 再生成 | キャッシュヒットで高速化 |
| AI コスト発生 | コスト削減 |

## Tests

24 テスト全 PASS（キャッシュ関連 9 テスト追加）

## Commits

### infra-automation
- `fb0c9fe` feat(summary-card): add input_hash cache for v0.2.1
